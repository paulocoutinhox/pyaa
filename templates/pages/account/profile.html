{% extends 'layouts/base.html' %}

{% load i18n %}
{% load pyaa %}

{% block content %}

{% url 'account_update_profile' as url_account_update_profile %}
{% url 'account_update_avatar' as url_account_update_avatar %}
{% url 'account_update_address' as url_account_update_address %}
{% url 'account_change_password' as url_account_change_password %}
{% url 'account_delete' as url_account_delete %}
{% url 'account_logout' as url_account_logout %}
{% url 'account_subscriptions' as url_account_subscriptions %}
{% url 'account_credits' as url_account_credits %}
{% url 'account_credit_purchases' as url_account_credit_purchases %}
{% url 'account_product_purchases' as url_account_product_purchases %}

<div class="container mx-auto px-4 py-8 max-w-2xl">
    {% element page_header centered=True subtitle=True %}
        {% translate "title.account-profile" %}
        {% slot subtitle %}
            {% translate "subtitle.my-account" %}
        {% endslot %}
    {% endelement %}

    <!-- Profile Info Card -->
    {% element card %}
        <div class="flex items-center gap-4">
            <div class="flex-shrink-0">
                {% include 'partials/customer_avatar.html' %}
            </div>
            <div class="flex-grow">
                <h5 class="font-semibold text-lg">{{ user.get_full_name|default:user.username }}</h5>
                {% with user.customer.credits as credits %}
                <p class="text-base-content/70 mb-2">
                    {% if credits > 0 %}
                        {% translate "customer.credits" %}: <span class="badge badge-primary">{{ credits }}</span>
                    {% else %}
                        {% translate "customer.no-credits" %}
                    {% endif %}
                </p>
                {% endwith %}
                <a href="{{ url_account_update_profile }}" class="btn btn-outline btn-primary btn-sm">
                    <i class="fa-solid fa-pen mr-1"></i>
                    {% translate "button.update-profile" %}
                </a>
            </div>
        </div>
    {% endelement %}

    <!-- Quick Actions -->
    {% element card class="mt-4" %}
        {% slot header %}
            <h6 class="font-semibold">{% translate "subtitle.my-purchases" %}</h6>
        {% endslot %}

        <div class="grid grid-cols-2 gap-3 w-full">
            <a href="{{ url_account_product_purchases }}" class="col-span-2 flex flex-col items-center justify-center p-4 rounded-lg bg-base-200 hover:bg-base-300 transition-colors">
                <i class="fa-solid fa-bag-shopping text-2xl mb-2"></i>
                <span class="text-center">{% translate "button.account-product-purchases" %}</span>
            </a>
            <a href="{{ url_account_credits }}" class="flex flex-col items-center justify-center p-4 rounded-lg bg-base-200 hover:bg-base-300 transition-colors">
                <i class="fa-solid fa-coins text-2xl mb-2"></i>
                <span class="text-center text-sm">{% translate "button.account-credits" %}</span>
            </a>
            <a href="{{ url_account_credit_purchases }}" class="flex flex-col items-center justify-center p-4 rounded-lg bg-base-200 hover:bg-base-300 transition-colors">
                <i class="fa-solid fa-cart-shopping text-2xl mb-2"></i>
                <span class="text-center text-sm">{% translate "button.account-credit-purchases" %}</span>
            </a>
            <a href="{{ url_account_subscriptions }}" class="col-span-2 flex flex-col items-center justify-center p-4 rounded-lg bg-base-200 hover:bg-base-300 transition-colors">
                <i class="fa-solid fa-calendar-check text-2xl mb-2"></i>
                <span class="text-center">{% translate "button.account-subscriptions" %}</span>
            </a>
        </div>
    {% endelement %}

    <!-- Account Settings -->
    {% element card class="mt-4" %}
        {% slot header %}
            <h6 class="font-semibold">{% translate "subtitle.account-settings" %}</h6>
        {% endslot %}

        <ul class="list bg-base-100 w-full p-0">
            <li class="list-row">
                <a href="{{ url_account_update_profile }}" class="flex justify-between">
                    <div><i class="fa-solid fa-user text-primary mr-3"></i></div>
                    <div>{% translate "button.update-profile" %}</div>
                    <div><i class="fa-solid fa-chevron-right"></i></div>
                </a>
            </li>
            <li class="list-row">
                <a href="{{ url_account_change_password }}" class="flex justify-between">
                    <div><i class="fa-solid fa-shield-halved text-primary mr-3"></i></div>
                    <div>{% translate "button.change-password" %}</div>
                    <div><i class="fa-solid fa-chevron-right"></i></div>
                </a>
            </li>
            <li class="list-row">
                <a href="{{ url_account_update_avatar }}" class="flex justify-between">
                    <div><i class="fa-solid fa-image text-primary mr-3"></i></div>
                    <div>{% translate "button.update-avatar" %}</div>
                    <div><i class="fa-solid fa-chevron-right"></i></div>
                </a>
            </li>
            <li class="list-row">
                <a href="{{ url_account_update_address }}" class="flex justify-between">
                    <div><i class="fa-solid fa-location-dot text-primary mr-3"></i></div>
                    <div>{% translate "button.update-address" %}</div>
                    <div><i class="fa-solid fa-chevron-right"></i></div>
                </a>
            </li>
        </ul>
    {% endelement %}

    <!-- Danger Zone -->
    {% element card class="mt-4" %}
        {% slot header %}
            <h6 class="font-semibold text-error">{% translate "subtitle.danger-zone" %}</h6>
        {% endslot %}

        <ul class="list bg-base-100 w-full p-0">
            <li class="list-row">
                <a href="{{ url_account_delete }}" class="flex justify-between text-error hover:bg-error/10">
                    <div><i class="fa-solid fa-trash mr-3"></i></div>
                    <div>{% translate "button.account-delete" %}</div>
                    <div><i class="fa-solid fa-chevron-right"></i></div>
                </a>
            </li>
            <li class="list-row">
                <a href="{{ url_account_logout }}" class="flex justify-between text-error hover:bg-error/10">
                    <div><i class="fa-solid fa-right-from-bracket mr-3"></i></div>
                    <div>{% translate "button.account-logout" %}</div>
                    <div><i class="fa-solid fa-chevron-right"></i></div>
                </a>
            </li>
        </ul>
    {% endelement %}
</div>

{% endblock content %}
